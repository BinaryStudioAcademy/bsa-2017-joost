<div class="work-space-container message-list">
  <div class="jg-container mdl-card mdl-shadow--2dp">
    <div class="mdl-card__title mdl-shadow--2dp dialog-title">
        <img src="{{dialogImage | avatarPipe}}" class="material-icons mdl-list__item-avatar">
        <div>
          <h2 class="mdl-card__title-text title-text">{{dialogName}}</h2>
          <div class="group-members accordion" *ngIf="isGroup && groupMembers!=null">
           <input type="checkbox" checked="">
            <h3><i></i>Members: {{groupMembers.length}}</h3>
            <ul>
              <li *ngFor="let member of groupMembers">
                <span class="member__name">{{member.FirstName}} {{member.LastName}}</span>
              </li>
            </ul>
          </div>
        </div>
    </div>
    <div class="mdl-card__title jc-group-edit-title-container">
      <div class="main"> 
        <ul #scroll class="mdl-list scrollable messages-content" (scroll)="onScroll()" [scrollTop]="scroll.scrollTop">
          <div *ngFor="let message of messages">
              <li class="mdl-list__item mdl-list__item--three-line message-item" [class.self-message]="messageService.isOwnMessage(message, currentUser.Id)">
                  <div class="message-container">
                    <div *ngIf="!messageService.isOwnMessage(message, currentUser.Id)">
                        <img src="{{(isGroup ? getMember(message.SenderId).Avatar : dialogImage) | avatarPipe}}" class="material-icons mdl-list__item-avatar">
                    </div>
                    <div class="main-message-content-container">
                      <div class="message-header">
                        <div *ngIf="isGroup">
                            {{messageService.isOwnMessage(message, currentUser.Id) ? '' : getMember(message.SenderId).FirstName + ', '}}
                        </div>
                        <div *ngIf="!isGroup">
                          {{messageService.isOwnMessage(message, currentUser.Id) ? '': dialogName + ', '}}
                        </div>
                        <div>
                            {{message.CreatedAt | date:'HH:mm:ss'}}
                        </div>   
                      </div>
                      <div class="message-content">
                          <div class="message-text" *ngIf="message.Text" [innerHTML]="message.Text">
                          </div>
                          <div *ngIf="message.AttachedFile && isImage(message.AttachedFile)" (click)="onShowModal(message.AttachedFile)">
                            <img src="{{message.AttachedFile | attachedImagePipe}}">
                          </div>
                          <a *ngIf="message.AttachedFile && !isImage(message.AttachedFile)" [attr.href]="getFullFileUrl(message.AttachedFile)" class="attached-file">
                           <div class="att-file-container" >  <!-- [class.attched-in-self-msg]="!messageService.isOwnMessage(message, receiverId)" -->
                              <i class="material-icons">insert_drive_file</i>
                              <div class="att-file-ex">
                                <strong>{{getFileExtension(message.AttachedFile)}}</strong> 
                              </div>
                            </div>  
                              
                          </a>
                      </div>
                    </div>
                  </div>
              </li>
          </div> 
        </ul>    
      </div>
    </div>
    <div class ="mdl-card__actions mdl-card--border message-input-container send-message-container">     
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" id="messageText" (keyup.enter)="send(messageText)" [(ngModel)]="messageText">
          <!-- <label class="mdl-textfield__label" for="messageText">Message text...</label> -->
        </div>

        <label for="file-upload" class="custom-file-attach" id="file-upload-icon" title="Click to attach an image">
          <i class="material-icons" [class.green]="attachedImage">attach_file</i>
        </label>
        <!-- <div class="mdl-tooltip mdl-tooltip--top" for="file-upload-icon">
            Click to attach an image
        </div> -->
        <input id="file-upload" type="file" (click)="AttachImage($event)" name="file"/>

        <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect send-button" (click)="send(messageText)">
          <i class="material-icons">send</i>
        </button>
    </div>
  </div>
</div>

<div class="modal-container">
  <div class="wrapper-modal">
    <div class="modal through mdl-shadow--8dp">
      <i class="material-icons modal-close-button" (click)="onCloseModal()">close</i>
      <div>
        <a target="_blank" href="" id="modal-ref">
          <img src="" id="modal-img"/>
        </a>
      </div>
      <div class="image-tooltip">
          Click to open in a new tab
      </div>
  </div>
</div>
</div>
